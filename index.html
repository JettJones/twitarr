<!DOCTYPE html>
<html>
<head>
    <title>Twit-arr!</title>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <link rel='stylesheet' type='text/css' href='css/bootstrap.css'/>
    <link rel='stylesheet' type='text/css' href='css/bootstrap-responsive.css'/>
    <link rel='stylesheet' type='text/css' href='css/main.css'/>
</head>
<body>

<script type="text/x-handlebars" data-template-name="application">
    <div class='navbar'>
        <div class='navbar-inner'>
            <div class="navbar-center">
                <a class='brand hidden-phone'>Twit-arr!</a>
                <ul class='nav'>
                    <li>{{#linkTo "announcements"}}Announcements{{/linkTo}}</li>
                    <li class='dropdown visible-phone'>
                        <a href='#' class='dropdown-toggle' data-toggle='dropdown'>
                            <span>Posts</span>
                            <b class='caret'></b>
                        </a>
                        <ul class='dropdown-menu'>
                            <li>{{#linkTo "posts.popular"}}Popular{{/linkTo}}</li>
                            <li>{{#linkTo "posts.mine"}}My Stuff{{/linkTo}}</li>
                        </ul>
                    </li>
                    <li class="hidden-phone">{{#linkTo "posts.popular" }}Popular{{/linkTo}}</li>
                    {{#if logged_in}}
                    <li class="hidden-phone">{{#linkTo "posts.mine"}}My Stuff{{/linkTo}}</li>
                    {{/if}}
                </ul>
                <ul class='nav pull-right'>
                    {{#unless logged_in}}
                    <li>{{#linkTo "login"}}Login{{/linkTo}}</li>
                    {{else}}
                    <li class='dropdown'>
                        <a href='#' class='dropdown-toggle' data-toggle='dropdown'>
                            <span>{{ login_user }}</span>
                            <b class='caret'></b>
                        </a>
                        <ul class='dropdown-menu'>
                            <li>{{#linkTo "profile"}}Profile{{/linkTo}}</li>
                            <li><a tabindex='-1' href='#' {{ action 'logout' }}>Logout</a></li>
                        </ul>
                    </li>
                    {{/unless}}
                </ul>
            </div>
        </div>
    </div>
    <div class='main'>
        {{ outlet }}
    </div>
    <div class="pull-right">
        <span class="visible-desktop">desktop</span>
        <span class="visible-tablet">tablet</span>
        <span class="visible-phone">phone</span>
    </div>
</script>

<script type="text/x-handlebars" data-template-name="announcements">
    <div id='announcements'>
        <h3>Announcements</h3>
        {{#each post in controller.posts}}
            <div class='post-entry'>
                <span style="color: darkgray;">{{ post.username }}</span>
                <span class="pull-right" style="color: darkgray;" {{bindAttr data-livestamp="post.post_time"}} ></span>

                <div style="font-size: larger; font-weight: bold;">{{{ post.process_message }}}</div>
                {{#if can_delete}}
                    <div class="clearfix">
                        <a href="#" class="pull-right" {{ action 'delete' post.post_id }}>delete</a>
                    </div>
                {{/if}}
            </div>
        {{else}}
            <div>
                No announcements yet!
            </div>
        {{/each}}
        {{#if is_admin}}
            {{view Ember.TextArea placeholder='Announce something!' valueBinding='newPost'}}
            <button {{ action 'make_post' }}>Post it</button>
        {{/if}}
    </div>
</script>

<script type="text/x-handlebars" data-template-name="_user_route">
    <h3>{{route.username}}</h3>
</script>

<script type="text/x-handlebars" data-template-name="posts">
    {{view Ember.TextArea placeholder='Say something!' valueBinding='newPost'}}
    <button {{ action 'make_post' }}>Post it</button>

    {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="_post_list">
    {{#each post in controller.posts}}
        {{ render "postDetails" post }}
    {{else}}
        <div>
            No posts!
        </div>
    {{/each}}
</script>

<script type="text/x-handlebars" data-template-name="posts/user">
    <div>
        <div class="pull-right">
            {{#if is_friend}}
            <i class="icon-heart"></i>
            <a href="#" {{ action 'unfollow' }}>Following</a>
            {{else}}
            <a href="#" {{ action 'follow' }}>Not following</a>
            {{/if}}
        </div>
        <h3>{{user}}</h3>
    </div>
    {{ partial 'post_list' }}
</script>

<script type="text/x-handlebars" data-template-name="posts/mine">
    <h3>Mine</h3>
    {{ partial 'post_list' }}
</script>

<script type="text/x-handlebars" data-template-name="posts/popular">
    <h3>Popular</h3>
    {{ partial 'post_list' }}
</script>

<script type="text/x-handlebars" data-template-name="postDetails">
    <div class='post-entry'>
        {{#linkTo "posts.user" username style="color: darkgray;"}}{{ username }}{{/linkTo}}
        {{#if post_by_friend}}
            <i class="icon-heart"></i>
        {{/if}}
        <span class="pull-right" style="color: darkgray;" {{bindAttr data-livestamp="post_time"}} ></span>

        <div style="font-size: larger; font-weight: bold;">{{{ process_message }}}</div>
        <div class="post-details">
            {{#if liked_sentence}}
            <div class="pull-left">{{liked_sentence}}</div>
            {{/if}}
            <div class="clearfix"><div class="pull-right">
                {{#if can_delete}}
                    <a href="#" {{ action 'delete' post_id }}>delete</a>
                {{/if}}
                {{#if logged_in}}
                    <a href="#" {{ action 'favorite' post_id }}>
                        <i {{bindAttr class="liked_class"}}></i>
                    </a>
                {{/if}}
            </div></div>
        </div>
    </div>
</script>

<script type="text/x-handlebars" data-template-name="profile">
    <h3>Profile</h3>
</script>

<script type="text/x-handlebars" data-template-name="login">
    <form class="form-horizontal">
        <legend>I have an account</legend>
        <div class="control-group">
            <label class="control-label">Username</label>

            <div class="controls">
                {{ view Ember.TextField placeholder='username' valueBinding='username'}}
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">Password</label>

            <div class="controls">
                {{ view Ember.TextField type='password' valueBinding='password'}}
            </div>
        </div>
        <div class="control-group controls">
            <button {{ action 'login' }}>Login</button>
        </div>
    </form>
    <form class="form-horizontal" style="margin-top: 20px;">
        <legend>I don't have an account yet!</legend>
        <div class="control-group">
            <label class="control-label">Username</label>

            <div class="controls">
                <input type='text' id='new-username'/>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">Email</label>
            <div class="controls">
                <input type='text' id='new-email'/>
                <div style="margin-top: 5px;">
                    Your email will be used to notify you of your account creation. It is only visible to administrators.
                </div>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">Password</label>

            <div class="controls">
                <input type='password' id='new-password'/>
            </div>
        </div>
        <div class="control-group">
            <label class="control-label">Repeat password</label>

            <div class="controls">
                <input type='password' id='new-password2'/>
            </div>
        </div>
        <div class="control-group controls">
            <input class="btn" type="submit" id='new-user-submit' value="Request account"/>
        </div>
    </form>
</script>

<script type='text/javascript' src='js/jquery-2.0.1.min.js'></script>
<script type='text/javascript' src='js/underscore-min.js'></script>
<script type='text/javascript' src='js/handlebars-1.0.0-rc.4.js'></script>
<script type='text/javascript' src='js/ember-1.0.0-rc.6.1.js'></script>
<script type='text/javascript' src='js/bootstrap.min.js'></script>
<script type='text/javascript' src='js/moment.min.js'></script>
<script type='text/javascript' src='js/livestamp.min.js'></script>
<script type="text/javascript">
    window.Twitarr = Ember.Application.create();
</script>
<script type='text/javascript' src='js/message.js'></script>
<script type='text/javascript' src='js/routes.js'></script>
<script type='text/javascript' src='js/twitarr.js'></script>

</body>
</html>